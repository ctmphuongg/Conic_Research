

# This file was *autogenerated* from the file pollard.sage
from sage.all_cmdline import *   # import sage library

_sage_const_1 = Integer(1); _sage_const_391 = Integer(391); _sage_const_19 = Integer(19); _sage_const_357 = Integer(357); _sage_const_6 = Integer(6)
import random
from sage.all import gcd, primes, ceil, log

def pollard_factor(N, B):
    a = random.randint(_sage_const_1 , N - _sage_const_1 )
    d = gcd(a, N)
    if d != _sage_const_1 :
        return d

    b = a
    for l in primes(_sage_const_1 , B + _sage_const_1 ):
        e = ceil(log(N, l))
        b = power_mod(b, l**e, N)
        d = gcd(b - _sage_const_1 , N)
        if d != _sage_const_1 :
            if d < N:
                return d
            else:
                return -_sage_const_1 

    return -_sage_const_1 

if __name__ == "__main__":
    print(pollard_factor(_sage_const_391 , _sage_const_19 ))
    print(pollard_factor(_sage_const_357 , _sage_const_6 ))

